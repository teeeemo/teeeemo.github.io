<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.0 -->
    <script>
        window.materialVersion = "1.5.0"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">





        <link rel="dns-prefetch" href="https://cdn-city.livere.com"/>










    <!-- Title -->
    
    <title>
        
        Emitter 学习笔记 | 
        
        Teeeemoji
    </title>

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="format-detection" content="telephone=no"/>
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Teeeemoji">
    <meta name="description" itemprop="description"
          content=" Emitter 学习笔记学习感想最好的学习资料是官方文档, 由于是英语的, 可能造成心里压力, 阅读不下去(我就是). ">
    <meta name="keywords"
          content="  ,学习  ,emitter  ,nodejs  ,emit ">

    <!-- Import lsloader -->
    <script>(function () {
            window.lsloader = {jsRunSequence: [], jsnamemap: {}, cssnamemap: {}};
            lsloader.removeLS = function (key) {
                try {
                    localStorage.removeItem(key)
                } catch (e) {
                }
            };
            lsloader.setLS = function (key, val) {
                try {
                    localStorage.setItem(key, val)
                } catch (e) {
                }
            };
            lsloader.getLS = function (key) {
                var val = "";
                try {
                    val = localStorage.getItem(key)
                } catch (e) {
                    val = ""
                }
                return val
            };
            versionString = "/*" + (window.materialVersion || "unknownVersion") + "*/";
            lsloader.clean = function () {
                try {
                    var keys = [];
                    for (var i = 0; i < localStorage.length; i++) {
                        keys.push(localStorage.key(i))
                    }
                    keys.forEach(function (key) {
                        var data = lsloader.getLS(key);
                        if (window.oldVersion) {
                            var remove = window.oldVersion.reduce(function (p, c) {
                                return p || data.indexOf("/*" + c + "*/") !== -1
                            }, false);
                            if (remove) {
                                lsloader.removeLS(key)
                            }
                        }
                    })
                } catch (e) {
                }
            };
            lsloader.clean();
            lsloader.load = function (jsname, jspath, cssonload, isJs) {
                if (typeof cssonload === "boolean") {
                    isJs = cssonload;
                    cssonload = undefined
                }
                isJs = isJs || false;
                cssonload = cssonload || function () {
                    };
                var code;
                code = this.getLS(jsname);
                if (code && code.indexOf(versionString) === -1) {
                    this.removeLS(jsname);
                    this.requestResource(jsname, jspath, cssonload, isJs);
                    return
                }
                if (code) {
                    var versionNumber = code.split(versionString)[0];
                    if (versionNumber != jspath) {
                        console.log("reload:" + jspath);
                        this.removeLS(jsname);
                        this.requestResource(jsname, jspath, cssonload, isJs);
                        return
                    }
                    code = code.split(versionString)[1];
                    if (isJs) {
                        this.jsRunSequence.push({name: jsname, code: code});
                        this.runjs(jspath, jsname, code)
                    } else {
                        document.getElementById(jsname).appendChild(document.createTextNode(code));
                        cssonload()
                    }
                } else {
                    this.requestResource(jsname, jspath, cssonload, isJs)
                }
            };
            lsloader.requestResource = function (name, path, cssonload, isJs) {
                var that = this;
                if (isJs) {
                    this.iojs(path, name, function (path, name, code) {
                        that.setLS(name, path + versionString + code);
                        that.runjs(path, name, code)
                    })
                } else {
                    this.iocss(path, name, function (code) {
                        document.getElementById(name).appendChild(document.createTextNode(code));
                        that.setLS(name, path + versionString + code)
                    }, cssonload)
                }
            };
            lsloader.iojs = function (path, jsname, callback) {
                var that = this;
                that.jsRunSequence.push({name: jsname, code: ""});
                try {
                    var xhr = new XMLHttpRequest;
                    xhr.open("get", path, true);
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState == 4) {
                            if (xhr.status >= 200 && xhr.status < 300 || xhr.status == 304) {
                                if (xhr.response != "") {
                                    callback(path, jsname, xhr.response);
                                    return
                                }
                            }
                            that.jsfallback(path, jsname)
                        }
                    };
                    xhr.send(null)
                } catch (e) {
                    that.jsfallback(path, jsname)
                }
            };
            lsloader.iocss = function (path, jsname, callback, cssonload) {
                var that = this;
                try {
                    var xhr = new XMLHttpRequest;
                    xhr.open("get", path, true);
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState == 4) {
                            if (xhr.status >= 200 && xhr.status < 300 || xhr.status == 304) {
                                if (xhr.response != "") {
                                    callback(xhr.response);
                                    cssonload();
                                    return
                                }
                            }
                            that.cssfallback(path, jsname, cssonload)
                        }
                    };
                    xhr.send(null)
                } catch (e) {
                    that.cssfallback(path, jsname, cssonload)
                }
            };
            lsloader.iofonts = function (path, jsname, callback, cssonload) {
                var that = this;
                try {
                    var xhr = new XMLHttpRequest;
                    xhr.open("get", path, true);
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState == 4) {
                            if (xhr.status >= 200 && xhr.status < 300 || xhr.status == 304) {
                                if (xhr.response != "") {
                                    callback(xhr.response);
                                    cssonload();
                                    return
                                }
                            }
                            that.cssfallback(path, jsname, cssonload)
                        }
                    };
                    xhr.send(null)
                } catch (e) {
                    that.cssfallback(path, jsname, cssonload)
                }
            };
            lsloader.runjs = function (path, name, code) {
                if (!!name && !!code) {
                    for (var k in this.jsRunSequence) {
                        if (this.jsRunSequence[k].name == name) {
                            this.jsRunSequence[k].code = code
                        }
                    }
                }
                if (!!this.jsRunSequence[0] && !!this.jsRunSequence[0].code && this.jsRunSequence[0].status != "failed") {
                    var script = document.createElement("script");
                    script.appendChild(document.createTextNode(this.jsRunSequence[0].code));
                    script.type = "text/javascript";
                    document.getElementsByTagName("head")[0].appendChild(script);
                    this.jsRunSequence.shift();
                    if (this.jsRunSequence.length > 0) {
                        this.runjs()
                    }
                } else if (!!this.jsRunSequence[0] && this.jsRunSequence[0].status == "failed") {
                    var that = this;
                    var script = document.createElement("script");
                    script.src = this.jsRunSequence[0].path;
                    script.type = "text/javascript";
                    this.jsRunSequence[0].status = "loading";
                    script.onload = function () {
                        that.jsRunSequence.shift();
                        if (that.jsRunSequence.length > 0) {
                            that.runjs()
                        }
                    };
                    document.body.appendChild(script)
                }
            };
            lsloader.tagLoad = function (path, name) {
                this.jsRunSequence.push({name: name, code: "", path: path, status: "failed"});
                this.runjs()
            };
            lsloader.jsfallback = function (path, name) {
                if (!!this.jsnamemap[name]) {
                    return
                } else {
                    this.jsnamemap[name] = name
                }
                for (var k in this.jsRunSequence) {
                    if (this.jsRunSequence[k].name == name) {
                        this.jsRunSequence[k].code = "";
                        this.jsRunSequence[k].status = "failed";
                        this.jsRunSequence[k].path = path
                    }
                }
                this.runjs()
            };
            lsloader.cssfallback = function (path, name, cssonload) {
                if (!!this.cssnamemap[name]) {
                    return
                } else {
                    this.cssnamemap[name] = 1
                }
                var link = document.createElement("link");
                link.type = "text/css";
                link.href = path;
                link.rel = "stylesheet";
                link.onload = link.onerror = cssonload;
                var root = document.getElementsByTagName("script")[0];
                root.parentNode.insertBefore(link, root)
            };
            lsloader.runInlineScript = function (scriptId, codeId) {
                var code = document.getElementById(codeId).innerText;
                this.jsRunSequence.push({name: scriptId, code: code}
                );
                this.runjs()
            };
            lsloader.loadCombo = function (jslist) {
                var updateList = "";
                var requestingModules = {};
                for (var k in jslist) {
                    var LS = this.getLS(jslist[k].name);
                    if (!!LS) {
                        var version = LS.split(versionString)[0];
                        var code = LS.split(versionString)[1]
                    } else {
                        var version = ""
                    }
                    if (version == jslist[k].path) {
                        this.jsRunSequence.push({name: jslist[k].name, code: code, path: jslist[k].path})
                    } else {
                        this.jsRunSequence.push({
                            name: jslist[k].name,
                            code: null,
                            path: jslist[k].path,
                            status: "comboloading"
                        });
                        requestingModules[jslist[k].name] = true;
                        updateList += (updateList == "" ? "" : ";") + jslist[k].path
                    }
                }
                var that = this;
                if (!!updateList) {
                    var xhr = new XMLHttpRequest;
                    xhr.open("get", combo + updateList, true);
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState == 4) {
                            if (xhr.status >= 200 && xhr.status < 300 || xhr.status == 304) {
                                if (xhr.response != "") {
                                    that.runCombo(xhr.response, requestingModules);
                                    return
                                }
                            } else {
                                for (var i in that.jsRunSequence) {
                                    if (requestingModules[that.jsRunSequence[i].name]) {
                                        that.jsRunSequence[i].status = "failed"
                                    }
                                }
                                that.runjs()
                            }
                        }
                    };
                    xhr.send(null)
                }
                this.runjs()
            };
            lsloader.runCombo = function (comboCode, requestingModules) {
                comboCode = comboCode.split("/*combojs*/");
                comboCode.shift();
                for (var k in this.jsRunSequence) {
                    if (!!requestingModules[this.jsRunSequence[k].name] && !!comboCode[0]) {
                        this.jsRunSequence[k].status = "comboJS";
                        this.jsRunSequence[k].code = comboCode[0];
                        this.setLS(this.jsRunSequence[k].name, this.jsRunSequence[k].path + versionString + comboCode[0]);
                        comboCode.shift()
                    }
                }
                this.runjs()
            }
        })();</script>

    <!-- Import queue -->
    <script>function Queue() {
            this.dataStore = [];
            this.offer = b;
            this.poll = d;
            this.execNext = a;
            this.debug = false;
            this.startDebug = c;
            function b(e) {
                if (this.debug) {
                    console.log("Offered a Queued Function.")
                }
                if (typeof e === "function") {
                    this.dataStore.push(e)
                } else {
                    console.log("You must offer a function.")
                }
            }

            function d() {
                if (this.debug) {
                    console.log("Polled a Queued Function.")
                }
                return this.dataStore.shift()
            }

            function a() {
                var e = this.poll();
                if (e !== undefined) {
                    if (this.debug) {
                        console.log("Run a Queued Function.")
                    }
                    e()
                }
            }

            function c() {
                this.debug = true
            }
        }
        var queue = new Queue();</script>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Teeeemoji">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    
    
    <link rel=alternate type="application/atom+xml" href="atom.xml">
    
    

    <!--[if lte IE 9]>
    <link rel="stylesheet" href="/css/ie-blocker.css">

    
    <script src="/js/ie-blocker.zhCN.js"></script>
    
    <![endif]-->

    <!-- Import CSS -->
    
    <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
    <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?MKetZV3cUTfDxvMffaOezg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

    

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #1D4E69 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #1D4E69 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #1D4E69 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-image: url(/img/background.png);
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icon -->

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">




    <!-- Import jQuery -->
    
    <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://teeeemoji.xyz">
    <meta property="og:type" content="blog">
    <meta property="og:title" content=" Emitter 学习笔记 |  Teeeemoji">
    <meta property="og:image" content="http://teeeemoji.xyz/img/favicon.png"/>
    <meta property="og:description"
          content=" Emitter 学习笔记学习感想最好的学习资料是官方文档, 由于是英语的, 可能造成心里压力, 阅读不下去(我就是). ">
    
    <meta property="og:article:tag" content="学习">
    
    <meta property="og:article:tag" content="emitter">
    
    <meta property="og:article:tag" content="nodejs">
    
    <meta property="og:article:tag" content="emit">
    

    
    <meta property="article:published_time" content="Sat Oct 21 2017 22:58:46 GMT+0800"/>
    <meta property="article:modified_time" content="Sat Oct 21 2017 23:37:31 GMT+0800"/>
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content=" Emitter 学习笔记 |  Teeeemoji">
    <meta name="twitter:description"
          content=" Emitter 学习笔记学习感想最好的学习资料是官方文档, 由于是英语的, 可能造成心里压力, 阅读不下去(我就是). ">
    <meta name="twitter:image" content="http://teeeemoji.xyz/img/favicon.png">
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:url" content="http://teeeemoji.xyz"/>

    <!-- Add canonical link for SEO -->
    
    <link rel="canonical" href="http://teeeemoji.xyz/2017/10/21/learn-emitter/index.html"/>
    

    <!-- Structured-data for SEO -->
    
    


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://teeeemoji.xyz/2017/10/21/learn-emitter/index.html",
    "headline": "Emitter 学习笔记",
    "datePublished": "Sat Oct 21 2017 22:58:46 GMT+0800",
    "dateModified": "Sat Oct 21 2017 23:37:31 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "Teeeemoji",
        "image": {
            "@type": "ImageObject",
            "url": "/img/avatar.png"
        },
        "description": "只是一个人,因为很想你,,日事清,不贰过"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Teeeemoji",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",学习,emitter,nodejs,emit",
    "description": "Emitter 学习笔记学习感想最好的学习资料是官方文档, 由于是英语的, 可能造成心里压力, 阅读不下去(我就是).",
}
</script>


    

    <!-- Analytics -->
    
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-107745524-1', 'auto');ga('send', 'pageview');
</script>
    
    
    <script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?509d90a4255b7b30ec9e4b444220889a';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(hm, s);
    })();
</script>
    
    
    <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=1264602602&web_id=1264602602" language="JavaScript"></script>
</div>
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle"><span class="MD-burger-layer"></span></button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Emitter-学习笔记"><span class="post-toc-number">1.</span> <span class="post-toc-text">Emitter 学习笔记</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#学习感想"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">学习感想</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#概要介绍"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">概要介绍</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#通过-demo-一步一步了解-Emitter"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">通过 demo 一步一步了解 Emitter</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo1-API-on-绑定事件-amp-emit-触发事件"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">demo1: API - on(绑定事件) & emit(触发事件)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo2-通过-emit-向事件回调方法传入参数"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">demo2: 通过 emit 向事件回调方法传入参数</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo3-事件回调方法的执行顺序"><span class="post-toc-number">1.3.3.</span> <span class="post-toc-text">demo3: 事件回调方法的执行顺序</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo4-API-once-只会被调用一次的回调方法"><span class="post-toc-number">1.3.4.</span> <span class="post-toc-text">demo4: API - once(只会被调用一次的回调方法)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo5-API-prependListener-在队首添加回调方法"><span class="post-toc-number">1.3.5.</span> <span class="post-toc-text">demo5: API - prependListener(在队首添加回调方法)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo6-API-prependOnceListener-队首绑定一次性回调"><span class="post-toc-number">1.3.6.</span> <span class="post-toc-text">demo6: API - prependOnceListener(队首绑定一次性回调)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo7-API-setMaxListeners-amp-getMaxListeners-get-amp-set-可绑定回调的上限"><span class="post-toc-number">1.3.7.</span> <span class="post-toc-text">demo7: API - setMaxListeners & getMaxListeners (get & set 可绑定回调的上限)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo8-API-listenerCount-某个事件回调列表的-length"><span class="post-toc-number">1.3.8.</span> <span class="post-toc-text">demo8: API - listenerCount(某个事件回调列表的 length)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo9-API-listeners-返回事件回调方法列表"><span class="post-toc-number">1.3.9.</span> <span class="post-toc-text">demo9: API - listeners(返回事件回调方法列表)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo10-removeAllListeners-移除全部事件回调"><span class="post-toc-number">1.3.10.</span> <span class="post-toc-text">demo10: removeAllListeners(移除全部事件回调)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo11-API-removeListener-移除单个事件回调"><span class="post-toc-number">1.3.11.</span> <span class="post-toc-text">demo11: API - removeListener(移除单个事件回调)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo12-特殊事件-error-事件"><span class="post-toc-number">1.3.12.</span> <span class="post-toc-text">demo12: 特殊事件 - error 事件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo13-特殊事件-process-uncaughtException"><span class="post-toc-number">1.3.13.</span> <span class="post-toc-text">demo13: 特殊事件 - process.uncaughtException</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo14-特殊事件-newListener"><span class="post-toc-number">1.3.14.</span> <span class="post-toc-text">demo14: 特殊事件 - newListener</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo15-特殊事件-removeListener"><span class="post-toc-number">1.3.15.</span> <span class="post-toc-text">demo15: 特殊事件 - removeListener</span></a></li></ol></li></ol></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/galaxy/galaxy-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                Emitter 学习笔记
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Teeeemoji</strong>
        <span>10月 21, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">devices other</i>
    <span class="visuallyhidden">devices other</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
    <li class="mdl-menu__item">在其它设备中阅读本文章</li>
    
        <img src="https://pan.baidu.com/share/qrcode?w=246&h=246&url=http://teeeemoji.xyz/2017/10/21/learn-emitter/">
    
</ul>

    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/emit/">emit</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/emitter/">emitter</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/nodejs/">nodejs</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/学习/">学习</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Emitter 学习笔记&url=http://teeeemoji.xyz/2017/10/21/learn-emitter/index.html&pic=http://teeeemoji.xyz/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=Emitter 学习笔记&url=http://teeeemoji.xyz/2017/10/21/learn-emitter/index.html&via=Teeeemoji" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://teeeemoji.xyz/2017/10/21/learn-emitter/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://teeeemoji.xyz/2017/10/21/learn-emitter/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h1 id="Emitter-学习笔记"><a href="#Emitter-学习笔记" class="headerlink" title="Emitter 学习笔记"></a>Emitter 学习笔记</h1><h2 id="学习感想"><a href="#学习感想" class="headerlink" title="学习感想"></a>学习感想</h2><p>最好的学习资料是<a href="https://nodejs.org/api/events.html" target="_blank" rel="external">官方文档</a>, 由于是英语的, 可能造成心里压力, 阅读不下去(我就是).</p>
<a id="more"></a>
<p>我个人是先从<a href="http://javascript.ruanyifeng.com/nodejs/events.html#toc8" target="_blank" rel="external">一篇 emitter 的博客</a>对 Emitter 稍有了解再去看官方文档的, 果然这个模块真是小还简单.</p>
<p>如果这篇文章有幸被你参考, 倍感荣幸!</p>
<h2 id="概要介绍"><a href="#概要介绍" class="headerlink" title="概要介绍"></a>概要介绍</h2><p><em>中文翻译</em> 不明所以, 大概是事件分发的意思.</p>
<ul>
<li>emit: 散发,发射</li>
<li>emitter: 发射器</li>
</ul>
<p>Nodejs 中很多 API 或者内部类是基于异步调用的事件机制的, 在 nodejs 中,所有能 emit 事件的类都继承自 Emitter</p>
<p>Emitter 是 events模块导出的唯一的类, 通常作为接口被其他类继承(或可以直接实例化使用,写 demo 的时候可以这么做)</p>
<p>一个继承了 Emitter 的类, 就被注册事件, 也有了响应事件调用回调函数的能力</p>
<p>当 Emitter 类的某个事件被触发了, 这个事件绑定的所有回调函数, 将会按照 <strong>绑定顺序</strong> <strong>同步</strong>执行.</p>
<h2 id="通过-demo-一步一步了解-Emitter"><a href="#通过-demo-一步一步了解-Emitter" class="headerlink" title="通过 demo 一步一步了解 Emitter"></a>通过 demo 一步一步了解 Emitter</h2><p><strong>注意: 所有的 demo 都是 ES6 的写法</strong></p>
<h3 id="demo1-API-on-绑定事件-amp-emit-触发事件"><a href="#demo1-API-on-绑定事件-amp-emit-触发事件" class="headerlink" title="demo1: API - on(绑定事件) &amp; emit(触发事件)"></a>demo1: API - on(绑定事件) &amp; emit(触发事件)</h3><p>通过 Emitter.on()方法绑定事件, 绑定的回调方法, 可以是匿名函数, 也可以是 ES6 的箭头函数</p>
<p><strong>注意: Emitter.on() 方法有个别名, 即 Emitter.addListener() 方法</strong></p>
<p><code>emitter.on(eventName, listener)</code></p>
<p>通过 Emitter.emit()方法触发事件,可以传参数的</p>
<p><code>emitter.emit(eventName[, ...args])</code></p>
<p>下面是一个可以直接执行的 demo</p>
<pre><code class="javascript">const EventEmitter = require(&#39;events&#39;);
class MyEmitter extends EventEmitter {}
const myEmitter = new MyEmitter();
myEmitter.on(&#39;event&#39;, () =&gt; {
//myEmitter.addListener(‘event&#39;, () =&gt; {
    console.log(&#39;an event occurred!&#39;);
});
myEmitter.emit(&#39;event&#39;);
</code></pre>
<p>输出结果:</p>
<pre><code class="bash">an event occurred!
</code></pre>
<h3 id="demo2-通过-emit-向事件回调方法传入参数"><a href="#demo2-通过-emit-向事件回调方法传入参数" class="headerlink" title="demo2: 通过 emit 向事件回调方法传入参数"></a>demo2: 通过 emit 向事件回调方法传入参数</h3><p>通过 on() 绑定的回调方法是可以带有参数的,这些参数通过 emit() 方法传进回调函数中</p>
<p>下面是一个可以直接执行的 demo</p>
<pre><code class="javascript">const EventEmitter = require(&#39;events&#39;);
const EventEmitter = require(&#39;events&#39;);
class MyEmitter extends EventEmitter {}
const myEmitter = new MyEmitter();
myEmitter.on(&#39;event&#39;, function(a, b) {
    console.log(a, b, this);
});
myEmitter.emit(&#39;event&#39;, &#39;a&#39;, &#39;b&#39;);
</code></pre>
<p>输出结果:</p>
<pre><code class="bash">a b MyEmitter {
  domain: null,
  _events: { event: [Function] },
  _eventsCount: 1,
  _maxListeners: undefined }
</code></pre>
<h3 id="demo3-事件回调方法的执行顺序"><a href="#demo3-事件回调方法的执行顺序" class="headerlink" title="demo3: 事件回调方法的执行顺序"></a>demo3: 事件回调方法的执行顺序</h3><p>一个事件可以绑定多个回调方法, 当这个事件被触发时, 所有的回调方法会按照它们绑定的顺序依次同步执行.</p>
<p><strong>注意: 回调事件中可以执行异步操作</strong></p>
<p>下面是一个可以直接执行的 demo</p>
<pre><code class="javascript">const EventsEmitter = require(&#39;events&#39;);
class MyEmitter extends EventsEmitter {}
let myEmitter = new MyEmitter();
const cb1 = () =&gt; setTimeout(() =&gt; {
    console.log(&#39;cb1&#39;)
}, 100);
// const cb1 = () =&gt; console.log(&#39;cb1&#39;);
const cb2 = () =&gt; console.log(&#39;cb2&#39;);
const cb3 = () =&gt; console.log(&#39;cb3&#39;);
const cb4 = () =&gt; console.log(&#39;cb4&#39;);
myEmitter.on(&#39;me&#39;,cb1);
myEmitter.on(&#39;me&#39;,cb2);
myEmitter.on(&#39;me&#39;,cb3);
myEmitter.on(&#39;me&#39;,cb4);
myEmitter.emit(&#39;me&#39;);
</code></pre>
<p>输出结果:</p>
<pre><code class="bash">cb2
cb3
cb4
cb1
</code></pre>
<h3 id="demo4-API-once-只会被调用一次的回调方法"><a href="#demo4-API-once-只会被调用一次的回调方法" class="headerlink" title="demo4: API - once(只会被调用一次的回调方法)"></a>demo4: API - once(只会被调用一次的回调方法)</h3><p>通过 on() 绑定的回调方法, 无论被 emit() 触发多少次, 都会被执行.</p>
<p>通过 once() 绑定的回调方法, 在回调方法绑定后第一次触发才会被执行.(实际上执行后该回调方法, 就在该事件的回调列表中去除了).</p>
<p><strong>注意: once() 指的是该回调方法只会被触发一次, 并非该事件只会被触发一次</strong></p>
<p>下面是一个可以直接执行的 demo</p>
<pre><code class="javascript">const EventsEmitter = require(&#39;events&#39;);
class MyEmitter extends EventsEmitter {}
let myEmitter = new MyEmitter();
const cb1 = () =&gt; console.log(&#39;cb1&#39;);
const cb2 = () =&gt; console.log(&#39;cb2&#39;);
const cb3 = () =&gt; console.log(&#39;cb3&#39;);
myEmitter.once(&#39;me&#39;,cb1);
myEmitter.once(&#39;me&#39;,cb2);
myEmitter.on(&#39;me&#39;,cb3);
// 执行两次 me 事件
myEmitter.emit(&#39;me&#39;);
myEmitter.emit(&#39;me&#39;);
</code></pre>
<p>输出结果:</p>
<pre><code class="bash">cb1
cb2
cb3
cb3
</code></pre>
<h3 id="demo5-API-prependListener-在队首添加回调方法"><a href="#demo5-API-prependListener-在队首添加回调方法" class="headerlink" title="demo5: API - prependListener(在队首添加回调方法)"></a>demo5: API - prependListener(在队首添加回调方法)</h3><p>绑定事件的方法,用法同 on().</p>
<p>然而通过 on 绑定的回调方法, 会 push 进回调方法队列, <strong>后绑定后执行</strong>.</p>
<p>通过 prependListener 绑定的回调方法, 则是会 unshift 进回调方法队列, <strong>后绑定先执行</strong>.</p>
<p>下面是一个可以直接执行的 demo</p>
<pre><code class="javascript">const EventsEmitter = require(&#39;events&#39;);
class MyEmitter extends EventsEmitter {
}
let myEmitter = new MyEmitter();
const cb1 = () =&gt; console.log(&#39;cb1&#39;);
const cb2 = () =&gt; console.log(&#39;cb2&#39;);
const cb3 = () =&gt; console.log(&#39;cb3&#39;);
const cb4 = () =&gt; console.log(&#39;cb4&#39;);
myEmitter.on(&#39;me&#39;, cb1);
myEmitter.on(&#39;me&#39;, cb2);
myEmitter.on(&#39;me&#39;, cb3);
myEmitter.prependListener(&#39;me&#39;, cb4);
myEmitter.emit(&#39;me&#39;);
</code></pre>
<p>输出结果:</p>
<pre><code class="bash">cb4
cb1
cb2
cb3
</code></pre>
<h3 id="demo6-API-prependOnceListener-队首绑定一次性回调"><a href="#demo6-API-prependOnceListener-队首绑定一次性回调" class="headerlink" title="demo6: API - prependOnceListener(队首绑定一次性回调)"></a>demo6: API - prependOnceListener(队首绑定一次性回调)</h3><p>不赘述, 参考 once() &amp; prependListener()<br>没有什么特殊的</p>
<h3 id="demo7-API-setMaxListeners-amp-getMaxListeners-get-amp-set-可绑定回调的上限"><a href="#demo7-API-setMaxListeners-amp-getMaxListeners-get-amp-set-可绑定回调的上限" class="headerlink" title="demo7: API - setMaxListeners &amp; getMaxListeners (get &amp; set 可绑定回调的上限)"></a>demo7: API - setMaxListeners &amp; getMaxListeners (get &amp; set 可绑定回调的上限)</h3><p>默认情况下,每个事件的可绑定回调方法上限是10个, 当绑定第11个回调方法的时候, <strong>程序会抛出 warning</strong>.虽然程序会抛出 warning, 但是当事件被触发的时候, 所有的回调方法都会正常执行.</p>
<p>setMaxListeners 方法是设置 Emitter 可绑定回调方法的上限(<strong>不区分每一个事件的可绑定回调方法上限</strong>, 可增可减).</p>
<p>getMaxListeners 方法则是获取某个 Emitter 的可绑定回调方法上限.</p>
<p>下面是一个可以直接执行的 demo</p>
<pre><code class="javascript">const EventsEmitter = require(&#39;events&#39;);
class MyEmitter extends EventsEmitter {
}
let myEmitter = new MyEmitter();
// 没有下面这一行, 程序会包 warning 哟
// myEmitter.setMaxListeners(20);
const cb1 = () =&gt; console.log(&#39;cb1&#39;);
const cb2 = () =&gt; console.log(&#39;cb2&#39;);
const cb3 = () =&gt; console.log(&#39;cb3&#39;);
const cb4 = () =&gt; console.log(&#39;cb4&#39;);
const cb5 = () =&gt; console.log(&#39;cb5&#39;);
const cb6 = () =&gt; console.log(&#39;cb6&#39;);
const cb7 = () =&gt; console.log(&#39;cb7&#39;);
const cb8 = () =&gt; console.log(&#39;cb8&#39;);
const cb9 = () =&gt; console.log(&#39;cb9&#39;);
const cb10 = () =&gt; console.log(&#39;cb10&#39;);
const cb11 = () =&gt; console.log(&#39;cb11&#39;);
const cb12 = () =&gt; console.log(&#39;cb12&#39;);
const cb13 = () =&gt; console.log(&#39;cb13&#39;);
const cb14 = () =&gt; console.log(&#39;cb14&#39;);
const cb15 = () =&gt; console.log(&#39;cb15&#39;);
myEmitter.on(&#39;me&#39;, cb1);
myEmitter.on(&#39;me&#39;, cb2);
myEmitter.on(&#39;me&#39;, cb3);
myEmitter.on(&#39;me&#39;, cb4);
myEmitter.on(&#39;me&#39;, cb5);
myEmitter.on(&#39;me&#39;, cb6);
myEmitter.on(&#39;me&#39;, cb7);
myEmitter.on(&#39;me&#39;, cb8);
myEmitter.on(&#39;me&#39;, cb9);
myEmitter.on(&#39;me&#39;, cb10);
myEmitter.on(&#39;me&#39;, cb11);
myEmitter.on(&#39;me&#39;, cb12);
myEmitter.on(&#39;me&#39;, cb13);
myEmitter.on(&#39;me&#39;, cb14);
myEmitter.on(&#39;me&#39;, cb15);
myEmitter.emit(&#39;me&#39;);
console.log(&#39;max listeners = &#39; + myEmitter.getMaxListeners());
</code></pre>
<p>输出结果:</p>
<pre><code class="bash">cb1
cb2
cb3
cb4
cb5
cb6
cb7
cb8
cb9
cb10
cb11
cb12
cb13
cb14
cb15
max listeners = 10
(node:14318) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 me listeners added. Use emitter.setMaxListeners() to increase limit
</code></pre>
<h3 id="demo8-API-listenerCount-某个事件回调列表的-length"><a href="#demo8-API-listenerCount-某个事件回调列表的-length" class="headerlink" title="demo8: API - listenerCount(某个事件回调列表的 length)"></a>demo8: API - listenerCount(某个事件回调列表的 length)</h3><p>这个方法返回某个事件所绑定的 回调方法的个数.右有两种写法, 结果是一致的.(这些 api 就是这么简单)</p>
<p>下面是一个可以直接执行的 demo</p>
<pre><code class="javascript">const EventsEmitter = require(&#39;events&#39;);
class MyEmitter extends EventsEmitter {}
let myEmitter = new MyEmitter();
myEmitter.on(&#39;event&#39;, () =&gt; {});
myEmitter.on(&#39;event&#39;, () =&gt; {});
console.log(EventsEmitter.listenerCount(myEmitter, &#39;event&#39;));
console.log(myEmitter.listenerCount(&#39;event&#39;));
</code></pre>
<p>输出结果:</p>
<pre><code class="bash">2
2
</code></pre>
<h3 id="demo9-API-listeners-返回事件回调方法列表"><a href="#demo9-API-listeners-返回事件回调方法列表" class="headerlink" title="demo9: API - listeners(返回事件回调方法列表)"></a>demo9: API - listeners(返回事件回调方法列表)</h3><p>获取某个事件的所有回调方法的列表, 顺序是回调方法的执行顺序.</p>
<p><strong>注: 想看到结果, 要把 listeners() 的返回值打印一下</strong></p>
<p>下面是一个可以直接执行的 demo</p>
<pre><code class="javascript">const EventsEmitter = require(&#39;events&#39;);
class MyEmitter extends EventsEmitter {
}
let myEmitter = new MyEmitter();
const cb1 = () =&gt; console.log(&#39;cb1&#39;);
const cb2 = () =&gt; console.log(&#39;cb2&#39;);
const cb3 = () =&gt; console.log(&#39;cb3&#39;);
const cb4 = () =&gt; console.log(&#39;cb4&#39;);
myEmitter.on(&#39;me&#39;, cb1);
myEmitter.on(&#39;me&#39;, cb2);
myEmitter.on(&#39;me&#39;, cb3);
myEmitter.on(&#39;me&#39;, cb4);
console.log(&#39;listeners list = &#39;);
console.log(myEmitter.listeners(&#39;me&#39;));
</code></pre>
<p>输出结果:</p>
<pre><code class="bash">listeners list = 
[ [Function: cb1],
  [Function: cb2],
  [Function: cb3],
  [Function: cb4]]
</code></pre>
<h3 id="demo10-removeAllListeners-移除全部事件回调"><a href="#demo10-removeAllListeners-移除全部事件回调" class="headerlink" title="demo10: removeAllListeners(移除全部事件回调)"></a>demo10: removeAllListeners(移除全部事件回调)</h3><p>无参数-&gt;移除所有的事件</p>
<p>有参数(eventName)-&gt;移除某一个事件(eventName)的所有回调方法</p>
<p>下面是一个可以直接执行的 demo</p>
<pre><code class="javascript">const EventsEmitter = require(&#39;events&#39;);
class MyEmitter extends EventsEmitter {
}
let myEmitter = new MyEmitter();
const cb1 = () =&gt; console.log(&#39;cb1&#39;);
const cb2 = () =&gt; console.log(&#39;cb2&#39;);
const cb3 = () =&gt; console.log(&#39;cb3&#39;);
myEmitter.on(&#39;me&#39;, cb1);
myEmitter.on(&#39;me&#39;, cb2);
myEmitter.on(&#39;my&#39;, cb3);
console.log(&#39;nothing removed:&#39;)
myEmitter.emit(&#39;me&#39;);
myEmitter.emit(&#39;my&#39;);
console.log(&#39;remove me:&#39;);
myEmitter.removeAllListeners(&#39;me&#39;);
myEmitter.emit(&#39;me&#39;);
myEmitter.emit(&#39;my&#39;);
console.log(&#39;remove all:&#39;);
myEmitter.removeAllListeners();
myEmitter.emit(&#39;me&#39;);
myEmitter.emit(&#39;my&#39;);
</code></pre>
<p>输出结果:</p>
<pre><code class="bash">nothing removed:
cb1
cb2
cb3
remove me:
cb3
remove all:
</code></pre>
<h3 id="demo11-API-removeListener-移除单个事件回调"><a href="#demo11-API-removeListener-移除单个事件回调" class="headerlink" title="demo11: API - removeListener(移除单个事件回调)"></a>demo11: API - removeListener(移除单个事件回调)</h3><p>移除某一个事件的某一个回调方法,入参 [eventName,callback] 一个都不能少, 否则报错</p>
<p>如果某个事件,绑定了3个相同的回调方法 cb3,那么 removeListener 只会移除最后绑定的那个 cb3</p>
<p>下面是一个可以直接执行的 demo</p>
<pre><code class="javascript">const EventsEmitter = require(&#39;events&#39;);
class MyEmitter extends EventsEmitter {
}
let myEmitter = new MyEmitter();
const cb1 = () =&gt; console.log(&#39;cb1&#39;);
const cb2 = () =&gt; console.log(&#39;cb2&#39;);
const cb3 = () =&gt; console.log(&#39;cb3&#39;);
myEmitter.on(&#39;me&#39;, cb1);
myEmitter.on(&#39;me&#39;, cb2);
myEmitter.on(&#39;me&#39;, cb3);
myEmitter.on(&#39;me&#39;, cb2);
myEmitter.on(&#39;me&#39;, cb3);
console.log(&#39;before remove:&#39;);
myEmitter.emit(&#39;me&#39;);
console.log(&#39;after remove cb2:&#39;);
myEmitter.removeListener(&#39;me&#39;,cb2);
myEmitter.emit(&#39;me&#39;);
</code></pre>
<p>输出结果:</p>
<pre><code class="bash">before remove:
cb1
cb2
cb3
cb2
cb3
after remove cb2:
cb1
cb2
cb3
cb3
</code></pre>
<h3 id="demo12-特殊事件-error-事件"><a href="#demo12-特殊事件-error-事件" class="headerlink" title="demo12: 特殊事件 - error 事件"></a>demo12: 特殊事件 - error 事件</h3><p>Emitter 支持一个特殊的事件 -error, 当这个事件被触发的时候, 如果找不到处理的回调方法, 会导致程序崩溃.</p>
<p>下面是一个可以直接执行的 demo</p>
<pre><code class="javascript">const EventsEmitter = require(&#39;events&#39;);
class MyEmitter extends EventsEmitter {}
let myEmitter = new MyEmitter();
myEmitter.emit(&#39;error&#39;, new Error(&#39;whoops!&#39;));
</code></pre>
<p>输出结果:<br><strong>程序非正常退出</strong></p>
<pre><code class="bash">events.js:163
      throw er; // Unhandled &#39;error&#39; event
      ^

Error: whoops!
    at Object.&lt;anonymous&gt; (/Users/zhangtingcen/Documents/my-repo/learning/index.js:60:25)
    at Module._compile (module.js:571:32)
    at Object.Module._extensions..js (module.js:580:10)
    at Module.load (module.js:488:32)
    at tryModuleLoad (module.js:447:12)
    at Function.Module._load (module.js:439:3)
    at Module.runMain (module.js:605:10)
    at run (bootstrap_node.js:423:7)
    at startup (bootstrap_node.js:147:9)
    at bootstrap_node.js:538:3
</code></pre>
<h3 id="demo13-特殊事件-process-uncaughtException"><a href="#demo13-特殊事件-process-uncaughtException" class="headerlink" title="demo13: 特殊事件 - process.uncaughtException"></a>demo13: 特殊事件 - process.uncaughtException</h3><p>因此我们需要一种手段, 来防止(上面)因为没有正确处理 error 事件导致程序直接崩溃.</p>
<p>可以通过给 precess 绑定 uncaughtException 事件, 当 Emitter 类的 error 事件被触发且没有 error 事件的回调方法时, process 的 uncaughtException 事件回调将会被触发.程序也不会崩溃.</p>
<p>下面是一个可以直接执行的 demo</p>
<pre><code class="javascript">const EventsEmitter = require(&#39;events&#39;);
class MyEmitter extends EventsEmitter {}
let myEmitter = new MyEmitter();
process.on(&#39;uncaughtException&#39;, (err) =&gt; {
    console.error(&#39;whoops! there was an error&#39;);
});
myEmitter.emit(&#39;error&#39;, new Error(&#39;whoops!&#39;));
</code></pre>
<p>输出结果:<br><strong>程序正常退出</strong></p>
<pre><code class="bash">whoops! there was an error
</code></pre>
<h3 id="demo14-特殊事件-newListener"><a href="#demo14-特殊事件-newListener" class="headerlink" title="demo14: 特殊事件 - newListener"></a>demo14: 特殊事件 - newListener</h3><p>newListener 事件回调方法, 会默认传入两个参数[eventName(事件名称),listener(回调方法)</p>
<p>在 newListener 事件回调方法中进行绑定事件的操作是一件危险的事情(<strong>分分钟造成死循环</strong>).如果确实要在 newListener 的回调方法中绑定新事件, 用 once 绑定这个危险的回调方法.</p>
<p>下面是一个可以直接执行的 demo</p>
<pre><code class="javascript">const EventsEmitter = require(&#39;events&#39;);
class MyEmitter extends EventsEmitter {}
let myEmitter = new MyEmitter();
let times = 0;
myEmitter.on(&#39;newListener&#39;,(event, listener) =&gt;{
//myEmitter.once(&#39;newListener&#39;,(event, listener) =&gt;{
    console.log(&#39;running times:&#39; + times++);
    console.log(event);
    console.log(listener);
    myEmitter.on(&#39;me&#39;,()=&gt;{})
});
myEmitter.on(&#39;me&#39;,()=&gt;console.log(&#39;start running newListener:&#39;));
myEmitter.emit(&#39;me&#39;);
</code></pre>
<p>输出结果:<br><strong>程序正常退出</strong></p>
<pre><code class="bash">程序陷入死循环,执行了不到一秒就崩溃了
</code></pre>
<h3 id="demo15-特殊事件-removeListener"><a href="#demo15-特殊事件-removeListener" class="headerlink" title="demo15: 特殊事件 - removeListener"></a>demo15: 特殊事件 - removeListener</h3><p>这个特殊事件已经(我学习的时候20171021)变成 <strong>stability:0 - deprecated;</strong>,就是不靠谱的, 移除已经在计划中</p>
<p>就不考虑这个了</p>

        
                <blockquote style="margin: 2em 0 0;padding: 0.5em 1em;border-left: 3px solid #F44336;background-color: #F5F5F5;list-style: none;">
                    <p><strong>
                         
                            This blog is under a <a href="/creativecommons.html" target="_blank">CC BY-NC-SA 3.0 Unported License</a>
                        </strong>
                        <br>
                        <strong>本文链接：</strong><a href="http://teeeemoji.xyz/2017/10/21/learn-emitter/">http://teeeemoji.xyz/2017/10/21/learn-emitter/</a>
                    </p>
                </blockquote>
        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 来必力 -->
<div id="livere-comment">
    <div id="lv-container" data-id="city" data-uid="MTAyMC8zMTIxNi83NzY1">
	<script type="text/ls-javascript" id="livere-discuss-script">
   (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];
       if (typeof LivereTower === 'function') { return; }
       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;
       e.parentNode.insertBefore(j, e);
   })(document, 'script');
	</script>
</div>
</div>
<style>
    #livere-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/10/19/idea-launcher-in-command-line/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar-header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="Teeeemoji's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        teeeemoji@163.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto: teeeeemoji@163.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">10</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/学习笔记/">学习笔记<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/学习笔记/node/">node<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/学习笔记/技术/">技术<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/日常/">日常<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/categories/日常/anime/">anime<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/日常/mac使用/">mac使用<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/日常/写作/">写作<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/日常/效率/">效率<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/日常/物件/">物件<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/gallery" title="图集">
                
                    <i class="material-icons sidebar-material-icons">photo</i>
                
                图集
            </a>
        </li>
        
            <li class="divider"></li>
        
    
        <li>
            <a href="/about" title="关于我">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                关于我
            </a>
        </li>
        
            <li class="divider"></li>
        
    
        <li>
            <a href="/links" title="友情链接">
                
                友情链接
            </a>
        </li>
        
    
        <li>
            <a href="/tags" title="标签云">
                
                标签云
            </a>
        </li>
        
    
        <li>
            <a href="/timeline" title="时间轴">
                
                时间轴
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">10</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

    <a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
             sidebar.about_theme
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
    </a>

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    
        <a href="http://weibo.com/u/6092439663/home" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-weibo">
                <span class="visuallyhidden">Weibo</span>
            </button><!--
     --></a>
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/teeeemoji" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2017&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>Teeeemoji
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    
        <script>lsloader.load("sm_js","/js/smoothscroll.js?lOy/ACj5suSNi7ZVFVbpFQ==", true)</script>
    







   





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->


    
        <script>lsloader.load("hanabi","/js/hanabi-browser-bundle.js?Pki5+pzkluqu53g+ouMWpA==", true)</script>
    


<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
        
        
        HanabiBrowser.start('pre code',true);
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
